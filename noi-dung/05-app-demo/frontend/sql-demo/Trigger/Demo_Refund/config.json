{
      "id": "trg-refund",
      "title": "Trigger 5: Ho√†n Ti·ªÅn",
      "type": "Trigger",
      "shortDesc": "Ki·ªÉm tra s·ªë ti·ªÅn ho√†n v√† ƒë·ªìng b·ªô tr·∫°ng th√°i payment, booking",
      "mdFile": "Trigger/Demo_Refund/problem.html",
      "sqlFile": "Trigger/Demo_Refund/trg_Refund.sql",
      "tables": [
            "REFUNDS",
            "PAYMENTS",
            "DATPHONG"
      ],
      "separateTables": [
            {
                  "name": "REFUNDS",
                  "label": "üí∏ B·∫£ng Ho√†n Ti·ªÅn",
                  "sqlBefore": "SELECT id, payment_id, so_tien_hoan AS refund_amount, trang_thai AS status, ly_do AS reason FROM REFUNDS WHERE payment_id = 1",
                  "sqlAfter": "SELECT id, payment_id, so_tien_hoan AS refund_amount, trang_thai AS status, ly_do AS reason FROM REFUNDS WHERE payment_id = 1",
                  "columns": [
                        {
                              "key": "id",
                              "label": "ID",
                              "isPk": true
                        },
                        {
                              "key": "payment_id",
                              "label": "Payment ID"
                        },
                        {
                              "key": "refund_amount",
                              "label": "‚ö° S·ªë Ti·ªÅn Ho√†n"
                        },
                        {
                              "key": "status",
                              "label": "‚ö° Tr·∫°ng Th√°i"
                        },
                        {
                              "key": "reason",
                              "label": "L√Ω Do"
                        }
                  ]
            },
            {
                  "name": "PAYMENTS",
                  "label": "üí∞ B·∫£ng Thanh To√°n",
                  "sqlBefore": "SELECT id, booking_id, so_tien AS amount, trang_thai AS status FROM PAYMENTS",
                  "sqlAfter": "SELECT id, booking_id, so_tien AS amount, trang_thai AS status FROM PAYMENTS",
                  "columns": [
                        {
                              "key": "id",
                              "label": "ID",
                              "isPk": true
                        },
                        {
                              "key": "booking_id",
                              "label": "Booking ID"
                        },
                        {
                              "key": "amount",
                              "label": "S·ªë Ti·ªÅn"
                        },
                        {
                              "key": "status",
                              "label": "‚ö° Status"
                        }
                  ]
            }
      ],
      "sqlFetchInitial": "SELECT TOP 20 r.id, r.payment_id, r.so_tien_hoan AS refund_amount, r.trang_thai AS status, p.trang_thai as payment_status FROM REFUNDS r LEFT JOIN PAYMENTS p ON p.id = r.payment_id ORDER BY r.created_at DESC",
      "sqlFetchBefore": "SELECT r.id, r.so_tien_hoan AS amount, p.trang_thai as payment_status, r.trang_thai as refund_status, d.trang_thai as booking_status FROM DATPHONG d JOIN PAYMENTS p ON p.booking_id = d.id LEFT JOIN REFUNDS r ON r.payment_id = p.id WHERE p.id = 1",
      "sqlFetchAfter": "SELECT r.id, r.so_tien_hoan AS amount, p.trang_thai as payment_status, r.trang_thai as refund_status, d.trang_thai as booking_status FROM DATPHONG d JOIN PAYMENTS p ON p.booking_id = d.id LEFT JOIN REFUNDS r ON r.payment_id = p.id WHERE p.id = 1",
      "columns": [
            {
                  "key": "id",
                  "label": "Refund ID",
                  "isPk": true
            },
            {
                  "key": "payment_id",
                  "label": "Payment ID"
            },
            {
                  "key": "refund_amount",
                  "label": "S·ªë Ti·ªÅn Ho√†n"
            },
            {
                  "key": "status",
                  "label": "Tr·∫°ng Th√°i"
            },
            {
                  "key": "payment_status",
                  "label": "Status Payment"
            }
      ],
      "params": [],
      "mockData": {
            "before": [],
            "after": [
                  {
                        "id": 1,
                        "payment_id": 1,
                        "refund_amount": 500000,
                        "status": "COMPLETED"
                  }
            ]
      }
}